---
title: "House of Excellence"

# Nome do documento PDF gerado
output-file: titulo do projeto
---

# Não sei se todas as questões de fontes e cores estão corretas, gostaria de saber se tem algo que estou fazendo errado e que o pacote da estat não cobre e preciso fazer manualmente.

```{r}
#| include: false
# Padronizações
```

```{r}
#| include: false
source("rdocs/source/packages.R")
```

```{r}
#Pacotes:

#| include: false
library(pacman)
pacman::p_load(tidyverse, knitr, readxl)

```

```{r}
#| include: false

#Tabela carregada

my_path = "C:\\Users\\Eriq\\Desktop\\Projects\\Ps estat\\Olimpiadas 2000 - 2016.xlsx"
sheet_names <- excel_sheets(my_path)
df <- lapply(sheet_names, function(sheet){
  data <- read_excel(my_path, sheet = sheet)
  colnames(data) <- c("Names", "Gender",       "Age",          "Height (cm)" , "Weight (lbs)", "Team",         "Sport" ,       "Event"  ,      "Medal")
  return(data)
})

teste <- df
df <- bind_rows(df)

```

Alguns testes para debugar

```{r}
teste[[1]] %>%
  group_by(Team) %>%
  filter(Medal == "Gold", Gender == "M") %>%
  distinct(Names)
```




```{r}

# Apenas medalhistas:

#| include: false
df <- df %>%
  filter(!is.na(Medal))
```

# Introdução

O seguinte projeto tem como objetivo trazer uma análise descritiva e exploratória de dados fornecidos pela "House of Excellence", visando otimizar o desempenho de seus atletas.

O banco de dados conta com 9 variáveis e 67.474 observações, sendo as mais importantes (tirando as informações básicas de cada atleta, como nome, peso e altura); "Sport": Esporte praticado pelo atleta, "Event": Nome do evento esportivo que o atleta participou, "Medal": medalha adiquirida pelo atleta na competição.

Todas as analises foram feitas utilizando o software RStudio

# Referencial Teórico

?

# Análises

## Top 5 países com maior número de mulheres medalhistas

```{r}

# crio novo banco de dados para mulheres medalhistas, alem disso, agrupo por equipes e faco a frequencia para cada um de forma ordenada e ficando apenas os 5 primeiros.

top_mulheres_pais <- df %>% 
  filter(Gender == "F") %>% 
  group_by(Team) %>%
  count(sort = T) %>%
  head(n = 5) 
```

```{r}
#plot utilizando fct_reorder para nao ser plotado um grafico em ordem alfabetica no lugar de ordenado por mais medalhas.

#| label: top5women
#| fig-cap: "Top5"  
  
top_mulheres_pais %>%
  ggplot(aes(x = fct_reorder(Team, n, .desc = T), y = n, fill = cores_estat[1])) +
  geom_col() +
  labs(y = "Quantidade de medalhistas femininas", x = "País", title = "Top 5 mulheres medalhistas") +
  theme_estat() + 
  guides(fill="none")
```

É possível observar, pela que @top5 os Estados Unidos estão na frente com uma vantagem esmagadora em comparação à equipe mais próxima (Rússia), tendo quase o dobro de medalhas conquistadas pelas mulheres de sua equipe. Em constraste com a primeira equipe colocada, as outras 4 equipes que estão no topo, tem número de medalhas muito próximas entre si.

## Valor IMC por esporte, estes sendo, ginástica, futebol, judô, atletismo e badminton

```{r}

#| include: false

imc_calculado <- df %>%
  select(Sport, `Height (cm)`, `Weight (lbs)`) %>%
  mutate(imc = `Height (cm)` / `Weight (lbs)`) %>%
  filter(Sport %in% c("Gymnastics", "Judo", "Athletics", "Badminton"))

df <- df %>%
  mutate(imc = round(`Height (cm)` / `Weight (lbs)`, 2))

```

```{r}

#| include: false
#Como a quantidade de "na's" é muito pequena, os "na's" serão considerados um evento aleatório e as linhas serão removidas.

imc_calculado <- na.omit(imc_calculado)
```

Foram analisadas: a variavel criada com nome de "IMC" onde o IMC foi calculado, sendo uma variavel contínua em relação a variavel "Sport" onde estão inclusos especificamente os esportes "Ginástica", "Atletismo", "Badminton" e "Judo".
A idéia é identificar se os atletas possuem perfis de IMC diferentes de acordo com o esporte praticado.

```{r}

imc_calculado %>% 
  ggplot(aes(x = reorder(Sport, imc, FUN = median, decreasing = T), y = imc, fill = cores_estat[1])) + 
  geom_boxplot() + 
  theme_estat() + 
  labs(y = "IMC", x = "Esporte", fill = "Esporte") + 
  guides(fill="none")


```

A partir do gráfico (estou tendo problemas de referenciar graficos), temos que diferentes esportes podem sim ter perfis diferentes de IMC, sendo que alguns podem ter uma menor variabilidade e uma quantidade mais concentrada em um valor enquanto outros esportes podem ter uma variabilidade maior e um perfil menos uniforme.




## 3. Top 3 medalhistas gerais por quantidade de cada tipo de medalha (27/10)
{r} df \<- df %\>% mutate(Medal_value = case_when( Medal == "Gold" \~ 3, Medal == "Silver" \~ 2, Medal == "Bronze" \~ 1 ))

{r}

top_medalhistas \<- df %\>% group_by(Names) %\>% summarise(n = n(), ) %\>% arrange(desc(n)) %\>% head()

{r}

top_nomes \<- top_medalhistas %\>% filter(n == 4) %\>% select(Names) %\>% as_vector()

terceiro \<- df %\>% filter(Names %in% top_nomes) %\>% group_by(Names) %\>% summarise(Medal_value = sum(Medal_value)) %\>% arrange(desc(Medal_value)) %\>% head(1) %\>% select(Names)

# Conclusões

?
